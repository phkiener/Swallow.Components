@implements IDisposable

@foreach (var descriptor in eventDescriptors)
{
    <meta itemprop="event-handler" content="@descriptor.ElementPath" data-event="@descriptor.EventName">
}

@code {

    private readonly List<ComponentEventDescriptor> eventDescriptors = [];

    [Inject]
    internal HandlerRegistration Handlers { get; set; } = null!;

    protected override void OnInitialized()
    {
        Handlers.OnHandlersDiscovered += ReloadDescriptors;
    }

    private void ReloadDescriptors(object? sender, EventArgs e)
    {
        eventDescriptors.Clear();
        eventDescriptors.AddRange(Handlers.Descriptors);

        StateHasChanged();
    }

    public void Dispose()
    {
        Handlers.OnHandlersDiscovered -= ReloadDescriptors;
    }

}
